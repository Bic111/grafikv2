# Implementation Plan: Refactor ParametryZmianTab.tsx to React Hook Form + Zod

**Branch**: `004-shift-parameters` | **Date**: 2025-11-10 | **Spec**: [spec.md](spec.md)
**Input**: Feature specification from `/specs/004-shift-parameters/spec.md`

## Summary

Refactor component `ParametryZmianTab.tsx` from uncontrolled components to React Hook Form + Zod validation. The component manages shift parameters for each day of the week with dynamic field arrays, real-time validation, and full CRUD integration with backend API. This improves form state management, reduces boilerplate, and provides type-safe validation.

## Technical Context

**Language/Version**: TypeScript (React 18+)
**Primary Dependencies**: React Hook Form, Zod, Axios/Fetch API, Radix UI (existing)
**Storage**: Backend SQLite via API (`/shift-parameters`)
**Testing**: Jest, React Testing Library (tests in parallel track)
**Target Platform**: Web (Next.js 14+)
**Project Type**: Full-stack (existing web application)
**Performance Goals**: <100ms validation response, <500ms API roundtrip
**Constraints**: Maintain existing UI structure, backward compatible with current backend
**Scale/Scope**: Single component refactor, 7 days per week × 2 categories (default/lead)

## Constitution Check

✅ **Modularity and Reusability**: The refactored component will be modular with clear separation between form logic (RHF), validation (Zod), and UI rendering. Reusable schema and hooks for validation.

✅ **API-First Design**: Existing backend API already defined (`/shift-parameters` endpoints). Frontend consumes through established client service (`shiftParameterAPI`).

⚠️ **Walidacja i zgodność z prawem pracy**: Not applicable - this feature manages shift parameter configuration only, not schedule generation. Validation is technical (format/range), not legal compliance.

✅ **Optymalizacja oparta na danych**: Not applicable at this stage - feature focuses on UI/form refactor. Backend already has CRUD operations.

✅ **Documentation**: Will update component JSDoc comments and maintain existing API documentation.

---

## Project Structure

### Documentation (this feature)

```text
specs/004-shift-parameters/
├── plan.md              # This file
├── research.md          # Phase 0 output (NOT generated - no unknowns)
├── data-model.md        # Phase 1 output
├── quickstart.md        # Phase 1 output
├── contracts/           # Phase 1 output (API already exists)
└── tasks.md             # Phase 2 output (via /speckit.tasks)
```

### Source Code (repository root)

```text
frontend/
├── components/employees/
│   ├── ParametryZmianTab.tsx       # Main component (REFACTORED)
│   └── forms/
│       ├── ShiftParameterForm.tsx  # Sub-component (UPDATED)
│       └── [other forms...]
├── lib/validation/
│   └── schemas.ts                  # Zod schemas (UPDATED)
└── services/api/
    └── client.ts                   # API client (uses existing shiftParameterAPI)

backend/
├── api/
│   └── shift_parameters.py         # Endpoints (NO CHANGES)
└── models.py                       # Database model (NO CHANGES)
```

**Structure Decision**: Existing web application structure maintained. Refactor is localized to `ParametryZmianTab.tsx` component and supporting form components/schemas. No new modules created.

---

## Implementation Phases

### Phase 0: Research (SKIPPED)
No NEEDS CLARIFICATION items. All technical decisions already clear from spec and existing codebase.

### Phase 1: Design

**1.1 Data Model** (`data-model.md`)
- ShiftParameter entity mapping
- Form state structure (RHF compatible)
- Validation rules from spec

**1.2 API Contracts** (`contracts/`)
- Document existing `/shift-parameters` endpoints
- Request/Response schemas (OpenAPI)

**1.3 Form Schema** (Zod)
- Time format validation (HH:MM)
- Range validation (godzina_od < godzina_do)
- Number validation (liczba_obsad >= 0)
- Polish error messages

**1.4 Component Architecture**
- RHF `useForm` for each day
- `useFieldArray` for dynamic shifts
- Sub-component: `ShiftParameterForm` (single shift row)
- Integrations: API client, Zod schema, error handling

**1.5 Quickstart** (`quickstart.md`)
- How to use refactored component
- Form structure, validation, submission flow

### Phase 2: Implementation (via `/speckit.tasks`)
Detailed tasks will be generated by `/speckit.tasks` command.

---

## Complexity Tracking

No Constitution violations identified. All design decisions follow established patterns in the codebase.

---

**Status**: Ready for Phase 2 Task Generation
**Next**: Run `/speckit.tasks` to generate actionable task list

